<!DOCTYPE html>
<html>
<head>
	<title>Theano</title>
	<link rel="stylesheet" href="w3.css">
	<meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body>

	<div class="w3-container w3-teal w3-center w3-margin ">
		<h1>Step By Step Guide To Install Theano</h1>
	</div>

	<div class="w3-container  w3-card w3-margin">
			<header class="w3-container  w3-center">
				<h3>What is Theano?</h3>
			</header>

			<p>
				Theano is a Python library for machine learning developed
				in University of Montreal. It provides optimized tools for various machine learning
				and deep learning tasks. It can achieve outstanding performace when used
				with gpu. Theano uses CUDA for accelerating computations on Nvidia Gpus.
				In this blog we will install Theano in Ubuntu 16.04 (64-bit)
				with <b>libgpuarray</b> backend for CUDA acceleration. <br><br>

				More details on Theano and it's documentaion can be found
				<a href="http://deeplearning.net/software/theano/">here</a>.
			</p>
	</div>

<!--- Step-1 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-I Install Nvidia Graphics Driver</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>
			Best way I have found is to install Nvidia Graphics Driver from
			<i>System Settings << Software & Updates << Additional Drivers </i> in Ubuntu 16.04.
		</p>
		<p>To verify driver installation run following command in terminal</p>
		<blockquote class="w3-gray  w3-padding">
				$ nvidia-smi
		</blockquote>
		<p>Similar output should be produced depending upon graphic card's configurations.</p>

		<img src="smi.png"></img>

	</div>

<!--- Step-2 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-II Install CUDA</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>
			Currently CUDA-8.0 is the public offering by Nvidia which is supported by Theano. We can download
			latest CUDA from <a href="https://developer.nvidia.com/cuda-downloads">Nvidia</a>.
			Cuda is available as</i> *.deb</i> package. After downloading the package, go to folder in which
			it is downloaded and run following commands to install
		</p>

		<blockquote class="w3-gray  w3-padding">
			$ sudo dpkg -i cuda-*.deb
			$ sudo apt update
			$ sudo apt install cuda
		</blockquote>

		<p>Once installation process is finished, we need to add PATH for CUDA in<i> ~/.bashrc</i> file
			(require admin privileges). Add following lines in<i> ~/.bashrc</i> file</p>
		<blockquote class="w3-gray  w3-padding">
			export CUDA_HOME=/usr/local/cuda-8.0<br>
			export LD_LIBRARY_PATH=${CUDA_HOME}/lib64 <br>
			export LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64/<br>
			PATH=${CUDA_HOME}/bin:${PATH} <br>
			export PATH<br>
		</blockquote>

		<p>At this point restarting the pc/laptop can be a good option.
			We can check if CUDA is installed correctly by running following command		</p>
		<blockquote class="w3-gray  w3-padding">
			$ nvcc -v
		</blockquote>
		<p>We should get similar output</p>
		<img src="cuda.png"></img>
	</div>


	<!--- Step-3 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-III Install Nvidia's Deep Neural Net Library (CuDNN)</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>
			Currently Theano supports CuDNN 5.1 but CuDNN 6.0 also works fine and it will also
			be supported in future releases. To download CuDNN, one has to register
			into <a href="https://developer.nvidia.com/developer-program/signup">Nvida Developer Program</a>.
			After registering one will be able to
			download CuDNN library (libcudnn6_*.deb). To install it, go to folder it is downloaded
			and run following command
		</p>

		<blockquote class="w3-gray  w3-padding">
			$ sudo dpkg -i libcudnn6_*.deb
		</blockquote>

	</div>

	<!--- Step-4 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-IV Install Dependencies</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>Theano depends upon several python packages and <b>OpenBLAS</b> library.<br>
			All dependencies are listed <a href="http://deeplearning.net/software/theano/install_ubuntu.html">here</a>.
			Install them by running following commands
		</p>

		<blockquote class="w3-gray  w3-padding">
			$ sudo apt install openblas-dev<br>
			$ sudo apt install python-dev<br>
			$ sudo apt install cmake<br>
			$ sudo pip install numpy<br>
			$ sudo pip install scipy<br>
			$ sudo pip install nose<br>
			$ sudp pip install sphinx<br>
			$ sudo pip install pygments<br>
			$ sudo pip install pydot-ng<br>
			$ sudo pip install pycuda<br>
			$ sudo pip install scikit-cuda<br>
		</blockquote>
	</div>

	<!--- Step-5 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-V Install <b>libgpuarray</b> Backend</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>To install <i>libgpuarray</i> run following commands<p>
			<blockquote class="w3-gray  w3-padding">
				$ git clone https://github.com/Theano/libgpuarray.git
			</blockquote>
			<p>If <i>git</i> is not installed, run following command</p>
			<blockquote class="w3-gray  w3-padding">
				$ sudo apt install git
			</blockquote>

			<p>Now, lets move ahead with <i>libgpuarray</i> installation
			<blockquote class="w3-gray  w3-padding">
				$ cd libgpuarray <br>
				$ git checkout tags/v0.6.2 -b v0.6.2 <br>
				$ mkdir Build <br>
				$ cd Build <br>
				$ cmake .. -DCMAKE_INSTALL_PREFIX=~/.local -DCMAKE_BUILD_TYPE=Release <br>
				$ make <br>
				$ sudo make install <br>
				$ cd .. <br>
			</blockquote>

			<p>Now add following lines in our beloved <i> ~/.bashrc</i> file</p>
			<blockquote class="w3-gray  w3-padding">
				export CPATH=$CPATH:~/.local/include <br>
				export LIBRARY_PATH=$LIBRARY_PATH:~/.local/lib <br>
				export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:~/.local/lib <br>
			</blockquote>

			<p>Restart the terminal, go to libgpuarray folder and run following commands</p>
			<blockquote class="w3-gray  w3-padding">
				$ python setup.py build <br>
				$ python setup.py install --user <br>
			</blockquote>

	</div>

	<!--- Step-6 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-VI Install Theano</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>Install Theano by running following command</p>
		<blockquote class="w3-gray  w3-padding">
			$ sudo pip install theano <br>
		</blockquote>

	</div>

	<!--- Step-7 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-VII Configuration File</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>To configure Theano a configuration file <i>.theanorc</i> is made in home directory.
			Add following line in <i>~/.theanorc</i> file</p>
		<blockquote class="w3-gray  w3-padding">
			[global] <br>
			device = cuda <br>
			floatX = float32 <br><br>

			[blas] <br>
			ldflags = -L/usr/local/lib -lopenblas <br><br>

			[nvcc] <br>
			fastmath = True <br>
		</blockquote>

	</div>

	<!--- Step-7 --->
	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Step-VIII Running Theano</h3>
	</div>

	<div class="w3-container w3-card w3-margin">
		<p>Open a Python interpreter and run following command</p>
		<blockquote class="w3-gray  w3-padding">
			>>>import theano <br>
		</blockquote>
		<p>Our output should look something like this</p>
		<img src="theano.png"></img>
		<p>We can see in output that Theano recognizes our Nvidia Graphics Card and shows warning for using
			CuDNN 6.1</p>
	</div>

	<div class="w3-container w3-panel w3-teal w3-margin">
		<h3>Acknowledgment</h3>
	</div>
	<div class="w3-container w3-card w3-margin">
		<p><a href="http://deeplearning.net/software/libgpuarray/installation.html#step-by-step-install">Deeplearning.net</a>
	</div>

	<div class="w3-panel w3-teal w3-center">
	<p class="w3-xxlarge" >Contact Me</p>
	<p>Mail @: <i>sachin.umrao.1512@gmail.com</i></p>
	</div>


</body>

</html>
